{"id":"csb-00c","title":"Remove or simplify the init command","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T11:41:46.872654-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.20477-08:00","closed_at":"2026-01-09T13:10:15.771191-08:00","close_reason":"Removed init command - create_vm auto-copies templates"}
{"id":"csb-06q","title":"Multi-agent Docker infrastructure","description":"Implement Docker-based multi-agent system per docs/plans/2026-01-11-multi-agent-workflow-design.md. Supersedes csb/VM approach.","status":"open","priority":1,"issue_type":"epic","owner":"danyel@gmail.com","created_at":"2026-01-11T15:24:22.698193-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T15:24:22.698193-08:00"}
{"id":"csb-07p","title":"Auto-confirm VM start prompt - avoid interactive question","description":"When running 'csb start', Lima asks 'Do you want to start the instance now? Yes/No'. This should be auto-confirmed since the user explicitly ran 'csb start'. Use limactl flags to skip the prompt.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T12:09:59.510443-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.203297-08:00","closed_at":"2026-01-09T12:12:26.385181-08:00","close_reason":"Added --tty=false to limactl create"}
{"id":"csb-0b9","title":"Phase 2: Single automated agent test","description":"Run entrypoint script with one agent against real tasks. Verify: completes work, handles failures gracefully, cleans up worktrees properly.","status":"closed","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T15:26:11.140631-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T21:25:29.335864-08:00","closed_at":"2026-01-11T21:25:29.335864-08:00","close_reason":"Phase 2 testing complete. Fixed bugs: (1) log() output to stderr, (2) bd command output redirection, (3) git worktree output redirection, (4) non-root user with correct UID, (5) env var CLAUDE_CODE_OAUTH_TOKEN. All tests pass except OAuth token expired (separate issue csb-cu8).","dependencies":[{"issue_id":"csb-0b9","depends_on_id":"csb-3ll","type":"blocks","created_at":"2026-01-11T15:26:29.62688-08:00","created_by":"danyel fisher"}]}
{"id":"csb-0fc","title":"Phase 4: Focus mode","description":"Connect dashboard to agent sessions: on Focus action call app.suspend() in Textual, spawn csb attach agentN subprocess, user runs claude --continue in tmux session, on exit resume dashboard.\n\nTesting:\n- Test app.suspend() pauses Textual correctly\n- Test subprocess spawns csb attach with correct agent\n- Test dashboard resumes after subprocess exits\n- Manual test: full focus flow with real tmux session","status":"open","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:38:14.740833-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:47:03.022222-08:00","dependencies":[{"issue_id":"csb-0fc","depends_on_id":"csb-l8l","type":"blocks","created_at":"2026-01-11T23:38:20.977701-08:00","created_by":"danyel fisher"},{"issue_id":"csb-0fc","depends_on_id":"csb-kva","type":"parent-child","created_at":"2026-01-11T23:38:34.577273-08:00","created_by":"danyel fisher"}]}
{"id":"csb-0ni","title":"Add csb health command to verify setup","description":"New command to verify:\n- Network rules applied\n- Claude CLI installed\n- API key valid\n\nHelps users debug issues with their sandbox setup.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-09T15:29:06.414129-08:00","created_by":"danyel","updated_at":"2026-01-09T18:39:11.059177-08:00","closed_at":"2026-01-09T18:39:11.059177-08:00","close_reason":"Won't fix: overkill. Health issues surface naturally when running csb start or claude."}
{"id":"csb-0s8","title":"Security: Sed injection vulnerability with ANTHROPIC_API_KEY","description":"Line 184 uses sed substitution with unescaped API key. If ANTHROPIC_API_KEY contains |, \u0026, \\, or newlines, sed will break or behave unexpectedly. Should escape the value or use a different substitution method.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-09T11:48:56.494147-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.20136-08:00","closed_at":"2026-01-09T11:57:13.286432-08:00","close_reason":"Fixed by adding escape_sed_replacement() helper and applying to all template substitutions"}
{"id":"csb-0sq","title":"Extract provision scripts from template.yaml","description":"Modularize template.yaml by extracting embedded bash scripts to separate files.\n\n## Goal\nMake the Lima template maintainable by:\n- Extracting scripts to shellcheck-able .sh files\n- Moving configs (dnsmasq allowlist) to separate files\n- Creating a build step to assemble the final template\n\n## Target Structure\n```\ncsb/\n  template.yaml.in          # Template with placeholders\n  provision/\n    01-packages.sh\n    02-user-setup.sh\n    03-network.sh\n  config/\n    dnsmasq-allowlist.conf\n    allowed-domains.txt\n  build-template.sh\n```\n\n## Benefits\n- Scripts can be linted with shellcheck\n- Domain allowlist easy to update\n- Individual scripts testable\n- Template stays readable","status":"closed","priority":3,"issue_type":"epic","created_at":"2026-01-09T20:12:00.514691-08:00","created_by":"danyel","updated_at":"2026-01-09T20:46:04.083205-08:00","closed_at":"2026-01-09T20:46:04.083205-08:00","close_reason":"Closed"}
{"id":"csb-0sy","title":"First-run reminder cannot be dismissed","description":"The bashrc checks for ~/.csb-plugins-configured but no code ever creates this file. Users see the reminder on every login forever. Fix: add 'touch ~/.csb-plugins-configured' to the instructions.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T15:24:14.020026-08:00","created_by":"danyel","updated_at":"2026-01-09T16:48:01.514965-08:00","closed_at":"2026-01-09T16:48:01.514965-08:00","close_reason":"Closed"}
{"id":"csb-162","title":"Network provisioning fails with resolvconf error on Debian","description":"During VM provisioning, the network restriction script fails with:\n\n```\nDropped protocol specifier '.dnsmasq' from 'lo.dnsmasq'. Using 'lo' (ifindex=1).\nFailed to set DNS configuration: Link lo is loopback device.\n```\n\nThe script uses `resolvconf -a lo.dnsmasq` which fails on Debian bookworm. \nNeed to update 03-network.sh to handle this differently.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-10T10:46:45.098753-08:00","created_by":"danyel","updated_at":"2026-01-11T21:54:30.333437-08:00","closed_at":"2026-01-11T21:54:30.333437-08:00","close_reason":"wontfix: from old csb version","comments":[{"id":22,"issue_id":"csb-162","author":"danyel","text":"## Reproduction Steps\n\n1. Create a test directory with git repo:\n```bash\nmkdir -p /tmp/csb-test \u0026\u0026 cd /tmp/csb-test\ngit init \u0026\u0026 echo \"test\" \u003e README.md \u0026\u0026 git add . \u0026\u0026 git commit -m \"init\"\n```\n\n2. Run csb create:\n```bash\ncsb create\n```\n\n3. Observe the failure during \"Configuring plugin installer\" stage.\n\n## Error Details\n\nFrom `/var/log/cloud-init-output.log`:\n\n```\n+ echo 'CSB_PROGRESS:Applying network restrictions'\nCSB_PROGRESS:Applying network restrictions\n+ [[ -n '' ]]\n+ ALLOWED_DOMAINS_FILE=/opt/csb/allowed-domains.txt\n+ generate_dnsmasq_config\n+ cat\n+ [[ -f /opt/csb/allowed-domains.txt ]]\n+ echo '# WARNING: /opt/csb/allowed-domains.txt not found, no domains allowed'\n+ systemctl stop dnsmasq\n+ command -v resolvconf\n+ echo 'nameserver 127.0.0.1'\n+ resolvconf -a lo.dnsmasq\nDropped protocol specifier '.dnsmasq' from 'lo.dnsmasq'. Using 'lo' (ifindex=1).\nFailed to set DNS configuration: Link lo is loopback device.\n```\n\n## Analysis\n\nThe `03-network.sh` script uses `resolvconf -a lo.dnsmasq` to set DNS configuration. On Debian Bookworm, this fails because:\n\n1. The `.dnsmasq` protocol specifier is not recognized\n2. Cannot set DNS on the loopback interface\n\n## Possible Fixes\n\n1. Use systemd-resolved instead of resolvconf\n2. Write directly to `/etc/resolv.conf` \n3. Use a different interface name\n4. Check if resolvconf supports the interface before calling\n\n## Environment\n\n- Debian 12 (Bookworm)\n- Lima VM with cloud-init provisioning","created_at":"2026-01-10T18:49:35Z"}]}
{"id":"csb-1pi","title":"Write a README for users stumbling into this github page","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T11:04:57.929676-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.205512-08:00","closed_at":"2026-01-09T11:11:39.330405-08:00","close_reason":"Created comprehensive README.md with installation, usage, commands, and architecture"}
{"id":"csb-1xi","title":"Bug: Network rules never applied - sandbox isn't sandboxed","description":"template.yaml has copyToHost: [] (empty) but provisioning script checks for /tmp/network-rules.sh. Nothing copies the network rules into the VM, so the firewall allowlist is never configured. Critical security gap.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-09T11:48:56.320088-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.201951-08:00","closed_at":"2026-01-09T11:56:18.09036-08:00","close_reason":"Fixed by embedding network rules directly in template.yaml provisioning script"}
{"id":"csb-2ba","title":"Remove unused network-rules.sh (duplicates template.yaml)","description":"## Problem\n\nThe file `network-rules.sh` duplicates network rules that are already defined in `template.yaml`.\n\n## Details\n\n- `network-rules.sh` contains network configuration that duplicates what's in `template.yaml`\n- The file appears to be unused/dead code\n- Having duplicate definitions creates maintenance burden and potential for inconsistencies\n\n## Proposed Solution\n\nEither:\n1. **Remove the file** if it's truly unused\n2. **Consolidate** by having the VM source the rules from a single location\n\nVerify the file is not referenced anywhere before removing.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T15:29:09.469471-08:00","created_by":"danyel","updated_at":"2026-01-09T15:39:23.150021-08:00","closed_at":"2026-01-09T15:39:23.150021-08:00","close_reason":"Duplicate of more detailed issue"}
{"id":"csb-2d7","title":"Add automated testing for csb script","description":"Currently the only testing is manual - running commands against real VMs. This led to the SSH clone bug being missed (csb-nb5).\n\nOptions to consider:\n1. **Unit tests with bats** - Test individual bash functions (ssh_to_https_url, get_agent_slot, etc.) without needing VMs\n2. **Integration tests** - Spin up actual Lima VMs and test full workflows (slow but thorough)\n3. **Dry-run mode** - Add a --dry-run flag that prints commands instead of executing them, for verification\n\nBats (Bash Automated Testing System) is probably the lowest friction option for testing pure functions.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-10T10:27:31.17766-08:00","created_by":"danyel","updated_at":"2026-01-11T21:54:36.750701-08:00","closed_at":"2026-01-11T21:54:36.750701-08:00","close_reason":"wontfix: from old bash csb version"}
{"id":"csb-2yw","title":"Rename cmd_start to cmd_create","description":"Rename the current cmd_start function to cmd_create. This preserves the current 'provision from scratch' behavior under a new command name. Update the case statement and help text accordingly.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T20:18:46.007611-08:00","created_by":"danyel","updated_at":"2026-01-09T20:24:23.089035-08:00","closed_at":"2026-01-09T20:24:23.089035-08:00","close_reason":"Renamed cmd_start to cmd_create in csb/csb"}
{"id":"csb-39d","title":"Extract allow_output helper for iptables (DRY)","description":"## Problem\nEvery iptables rule is duplicated for IPv4 and IPv6 (~15 times):\n```bash\niptables -A OUTPUT -o lo -j ACCEPT\nip6tables -A OUTPUT -o lo -j ACCEPT\n```\n\n## Solution\nCreate helper function:\n```bash\nallow_output() {\n    iptables -A OUTPUT \"\\$@\" 2\u003e/dev/null || true\n    ip6tables -A OUTPUT \"\\$@\" 2\u003e/dev/null || true\n}\n\n# Usage:\nallow_output -o lo -j ACCEPT\nallow_output -m state --state ESTABLISHED,RELATED -j ACCEPT\n```\n\n## File\n- `csb/template.yaml` (network rules section)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T15:37:49.152399-08:00","created_by":"danyel","updated_at":"2026-01-09T16:43:18.353114-08:00","closed_at":"2026-01-09T16:43:18.353114-08:00","close_reason":"Closed"}
{"id":"csb-3k2","title":"beads install causes cd errors during VM provisioning","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T12:09:43.076884-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.20354-08:00","closed_at":"2026-01-09T12:13:10.819278-08:00","close_reason":"Closed","comments":[{"id":2,"issue_id":"csb-3k2","author":"danyel","text":"Error seen during VM provisioning:\n```\n[csb] Installing base packages (git, tmux, python3, nodejs) ⠴\nbash: line 1: cd: /Users/danyel/code/MISC/torahmap2: No such file or directory\nbash: line 1: cd: /Users/danyel: No such file or directory\n```\n\nThe error comes from `npm install -g @anthropic-ai/beads` which appears to trigger some initialization that tries to cd to host paths that don't exist inside the VM.\n\nThe VM only has /workspace mounted. Beads might be reading ~/.beads or some other config that contains cached paths from the host.","created_at":"2026-01-09T20:09:49Z"},{"id":3,"issue_id":"csb-3k2","author":"danyel","text":"Root cause: limactl shell tries to cd to the host's current working directory inside the VM. When run from a directory like /Users/danyel/code/MISC/torahmap2, Lima emits errors because that path doesn't exist inside the VM.\n\nFix: Added --workdir flag to all limactl shell invocations to explicitly specify the working directory inside the VM.","created_at":"2026-01-09T20:13:10Z"}]}
{"id":"csb-3ll","title":"Phase 1: Manual two-agent test","description":"Validate core assumptions manually: 1) Start two Docker containers with shared volume 2) Manually run workflow commands 3) Verify: claiming works, worktrees work, push retry works, Beads changes visible instantly.","status":"closed","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T15:26:10.98179-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T20:54:58.275417-08:00","closed_at":"2026-01-11T20:54:58.275417-08:00","close_reason":"Manual testing complete. Verified: claiming works, worktrees work, beads changes visible instantly. Push retry logic validated but actual push blocked by token permissions (separate issue).","dependencies":[{"issue_id":"csb-3ll","depends_on_id":"csb-hai","type":"blocks","created_at":"2026-01-11T15:26:29.372844-08:00","created_by":"danyel fisher"},{"issue_id":"csb-3ll","depends_on_id":"csb-7in","type":"blocks","created_at":"2026-01-11T15:26:29.434272-08:00","created_by":"danyel fisher"},{"issue_id":"csb-3ll","depends_on_id":"csb-n6n","type":"blocks","created_at":"2026-01-11T15:26:29.493834-08:00","created_by":"danyel fisher"}]}
{"id":"csb-3sd","title":"Phase 3: Multi-agent integration test","description":"Run 2-4 agents simultaneously with 6-8 independent tasks. Verify: no collisions, all work completes, race handling works correctly.","status":"closed","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T15:26:11.304863-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T21:51:58.942254-08:00","closed_at":"2026-01-11T21:51:58.942254-08:00","close_reason":"Phase 3 multi-agent testing complete. Verified: (1) Multiple agents run concurrently, (2) Race handling works - losing agent detects 'claimed by another agent', (3) Each agent uses separate worktree, (4) No collisions. Fixed git safe.directory bug (need --add flag). OAuth token issue blocks actual Claude work (csb-cu8).","dependencies":[{"issue_id":"csb-3sd","depends_on_id":"csb-0b9","type":"blocks","created_at":"2026-01-11T15:26:29.762937-08:00","created_by":"danyel fisher"}]}
{"id":"csb-482","title":"Spinner ticks at 1s but code claims 0.1s","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-09T13:28:53.396137-08:00","created_by":"danyel","updated_at":"2026-01-09T13:36:44.249085-08:00","closed_at":"2026-01-09T13:36:44.249085-08:00","close_reason":"Added start_progress_spinner/stop_progress_spinner functions that run at 0.1s for smooth animation while polling at 1s"}
{"id":"csb-48k","title":"code review","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T11:43:22.730448-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.204524-08:00","closed_at":"2026-01-09T11:49:42.585134-08:00","close_reason":"Code review complete. Created 10 issues for findings (2 P1, 3 P2, 3 P3, 2 P4)."}
{"id":"csb-4w3","title":"[TEST-3] Multi-agent test task 3","description":"Test task for Phase 3 multi-agent validation. Simple placeholder task.","status":"closed","priority":0,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T21:34:04.446193-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T21:51:58.869572-08:00","closed_at":"2026-01-11T21:51:58.869572-08:00","close_reason":"Test tasks for Phase 3 validation. Cleaning up."}
{"id":"csb-5ms","title":"Fix README to match actual implementation","description":"## Issues\n\n1. **csb config documentation mismatch**: README shows `csb config` accepting arguments like `--cpus`, `--memory`, `--disk`, but the actual implementation just tells the user to run `limactl edit csb`.\n\n2. **Default values mismatch**: README lists different defaults than template.yaml:\n   - CPUs: README says 2, template.yaml says 4\n   - Memory: README says 2 GiB, template.yaml says 4 GiB\n   - Disk: README says 20 GiB, template.yaml says 30 GiB\n\n## Fix\n\nUpdate README to:\n- Remove fake `csb config` argument documentation\n- Correct the default resource values to match template.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T15:29:09.666534-08:00","created_by":"danyel","updated_at":"2026-01-09T18:32:00.913292-08:00","closed_at":"2026-01-09T18:32:00.913292-08:00","close_reason":"Fixed README to match actual implementation"}
{"id":"csb-5rc","title":"Create template.yaml.in with placeholders","description":"Convert template.yaml to template.yaml.in with placeholders for injected content.\n\n## Placeholders to add\n- {{SCRIPT_PACKAGES}} - system packages script\n- {{SCRIPT_USER_SETUP}} - user setup script  \n- {{SCRIPT_NETWORK}} - network restrictions script\n\n## Keep inline\n- Lima config (images, cpus, memory, mounts, ssh, etc.)\n- Environment variables section\n- Message and probes sections\n\n## Notes\n- The runtime placeholders ({{WORKSPACE_PATH}}, {{ANTHROPIC_API_KEY}}) stay as-is\n- Only provision script blocks get placeholders","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T20:12:23.264248-08:00","created_by":"danyel","updated_at":"2026-01-09T20:37:38.0013-08:00","closed_at":"2026-01-09T20:37:38.0013-08:00","close_reason":"Created template.yaml.in with {{SCRIPT_PACKAGES}}, {{SCRIPT_USER_SETUP}}, and {{SCRIPT_NETWORK}} placeholders","dependencies":[{"issue_id":"csb-5rc","depends_on_id":"csb-0sq","type":"parent-child","created_at":"2026-01-09T20:12:33.517253-08:00","created_by":"danyel"},{"issue_id":"csb-5rc","depends_on_id":"csb-6gd","type":"blocks","created_at":"2026-01-09T20:13:08.672228-08:00","created_by":"danyel"},{"issue_id":"csb-5rc","depends_on_id":"csb-dds","type":"blocks","created_at":"2026-01-09T20:13:08.728593-08:00","created_by":"danyel"},{"issue_id":"csb-5rc","depends_on_id":"csb-jhy","type":"blocks","created_at":"2026-01-09T20:13:08.784249-08:00","created_by":"danyel"},{"issue_id":"csb-5rc","depends_on_id":"csb-hi8","type":"blocks","created_at":"2026-01-09T20:13:08.835402-08:00","created_by":"danyel"}]}
{"id":"csb-60w","title":"Add shellcheck compliance to bash scripts","description":"Scripts would benefit from shellcheck annotations to improve code quality and catch potential issues.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T15:29:06.398911-08:00","created_by":"danyel","updated_at":"2026-01-09T15:39:23.148594-08:00","closed_at":"2026-01-09T15:39:23.148594-08:00","close_reason":"Duplicate of more detailed issue"}
{"id":"csb-6dr","title":"Implement cmd_snapshot to flatten VM disk","description":"Add csb snapshot command that:\n- Errors if no VM exists\n- Stops VM if running\n- Uses qemu-img convert to flatten diffdisk to ~/.csb/golden-$(uname -m).qcow2\n- Always overwrites existing golden image (no --force needed)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T20:19:11.468437-08:00","created_by":"danyel","updated_at":"2026-01-09T20:26:29.611985-08:00","closed_at":"2026-01-09T20:26:29.611985-08:00","close_reason":"Implemented cmd_snapshot in csb/csb"}
{"id":"csb-6g3","title":"Security: API key exposed in template file and logs","description":"## Problem\n\nThe ANTHROPIC_API_KEY is being substituted directly into template.yaml, which gets persisted to disk. This creates several security concerns:\n\n1. **Disk persistence** - The API key ends up in the generated template file on disk\n2. **Process visibility** - Could appear in process listings (ps aux, etc.)\n3. **Log exposure** - May be captured in various system and application logs\n\n## Affected Files\n\n- `template.yaml:266` - Template contains API key placeholder\n- `csb:266-271` - Script performs the substitution\n\n## Recommendation\n\nPass the API key via a runtime mechanism rather than template substitution:\n- Use environment variable injection at container/VM runtime\n- Use a secrets mount or file-based secret injection\n- Avoid persisting secrets in generated configuration files","status":"closed","priority":4,"issue_type":"bug","created_at":"2026-01-09T15:29:09.919451-08:00","created_by":"danyel","updated_at":"2026-01-09T18:45:43.571473-08:00","closed_at":"2026-01-09T18:45:43.571473-08:00","close_reason":"Won't fix: security hardening deferred"}
{"id":"csb-6gd","title":"Extract system packages script (01-packages.sh)","description":"Extract the first provision block (system mode, apt-get installs) to a separate script.\n\n## Current location\ntemplate.yaml lines 36-63\n\n## Extract to\ncsb/provision/01-packages.sh\n\n## Contents\n- apt-get update\n- apt-get install of base packages\n- apt-get clean\n\n## Notes\n- Add shellcheck directive at top\n- Keep CSB_PROGRESS markers for status display","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T20:12:22.330593-08:00","created_by":"danyel","updated_at":"2026-01-09T20:20:56.935576-08:00","closed_at":"2026-01-09T20:20:56.935576-08:00","close_reason":"Closed","dependencies":[{"issue_id":"csb-6gd","depends_on_id":"csb-0sq","type":"parent-child","created_at":"2026-01-09T20:12:33.32513-08:00","created_by":"danyel"}]}
{"id":"csb-6hr","title":"Implement new cmd_start using golden image","description":"Add new csb start command that:\n- Errors if no golden image exists (no fallback to provisioning)\n- Generates lima.yaml with workspace mount + API key\n- Points to golden-$(uname -m).qcow2 instead of base Debian\n- Skips provisioning scripts (already baked in)\n- Attaches to tmux session","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T20:19:15.415423-08:00","created_by":"danyel","updated_at":"2026-01-09T20:34:09.813667-08:00","closed_at":"2026-01-09T20:34:09.813667-08:00","close_reason":"Implemented cmd_start with golden image support","dependencies":[{"issue_id":"csb-6hr","depends_on_id":"csb-2yw","type":"blocks","created_at":"2026-01-09T20:19:25.507526-08:00","created_by":"danyel"}]}
{"id":"csb-6pw","title":"Startup is very slow - gets stuck on 'Installing Claude CLI'","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-09T13:19:44.777559-08:00","created_by":"danyel","updated_at":"2026-01-09T13:41:12.88508-08:00","closed_at":"2026-01-09T13:41:12.88508-08:00","close_reason":"Fixed npm install -g permission error by configuring npm to use ~/.npm-global prefix"}
{"id":"csb-72u","title":"Extract spinner constants (DRY)","description":"## Problem\nSpinner character string defined twice (lines 39 and 85) in different subshells.\nMagic number `10` used instead of string length.\n\n## Solution\nDefine constants at top of script:\n```bash\nreadonly SPINNER_CHARS=\"⠋⠙⠹⠸⠼⠴⠦⠧⠇⠏\"\nreadonly SPINNER_DELAY=0.1\n```\n\nUse `${#chars}` instead of magic `10`:\n```bash\ni=$(( (i + 1) % ${#chars} ))\n```\n\n## File\n- `csb/csb`","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T15:37:48.991377-08:00","created_by":"danyel","updated_at":"2026-01-09T16:46:36.136668-08:00","closed_at":"2026-01-09T16:46:36.136668-08:00","close_reason":"Closed"}
{"id":"csb-7fw","title":"Update help text and command documentation","description":"Update csb --help output to document all commands:\n- csb create: Provision VM from scratch\n- csb start: Start from golden image (requires prior snapshot)\n- csb snapshot: Capture current VM state as golden image\n- csb shell: Plain shell access","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-09T20:19:15.560962-08:00","created_by":"danyel","updated_at":"2026-01-09T20:34:37.879346-08:00","closed_at":"2026-01-09T20:34:37.879346-08:00","close_reason":"Help text updated in individual commits","dependencies":[{"issue_id":"csb-7fw","depends_on_id":"csb-2yw","type":"blocks","created_at":"2026-01-09T20:19:25.633466-08:00","created_by":"danyel"},{"issue_id":"csb-7fw","depends_on_id":"csb-6dr","type":"blocks","created_at":"2026-01-09T20:19:25.757861-08:00","created_by":"danyel"},{"issue_id":"csb-7fw","depends_on_id":"csb-6hr","type":"blocks","created_at":"2026-01-09T20:19:25.881265-08:00","created_by":"danyel"}]}
{"id":"csb-7he","title":"Simplify cmd_config - remove unused key/value params","description":"cmd_config accepts key/value arguments but ignores them - just tells user to run limactl edit. Remove dead parameter handling.","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-09T19:55:28.705482-08:00","created_by":"danyel","updated_at":"2026-01-09T20:35:08.723714-08:00","closed_at":"2026-01-09T20:35:08.723714-08:00","close_reason":"Closed"}
{"id":"csb-7in","title":"Create docker-compose.yml with shared workspace volume","description":"Create docker-compose.yml defining: shared workspace volume, init service for git clone, agent services with workspace mount. Safe config: no privileged, no docker.sock, no host network.","status":"closed","priority":1,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T15:26:10.659014-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T20:28:08.051008-08:00","closed_at":"2026-01-11T20:28:08.051008-08:00","close_reason":"Created docker-compose.yml with shared workspace volume, init service, 4 agent services, interactive service with port mapping, and safe config (no privileged, no docker.sock, bridge network)"}
{"id":"csb-7x9","title":"Special characters rendering wrong in progress display","description":"ANSI escape codes are being printed literally instead of interpreted. For example, the progress screen prints:\n\n[csb] Booting VM ⠏ \\033[0;90m[17s]\\033[0m (Y/n)\n\nInstead of rendering the gray color codes properly.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T16:57:13.055348-08:00","created_by":"danyel","updated_at":"2026-01-09T16:59:04.518259-08:00","closed_at":"2026-01-09T16:59:04.518259-08:00","close_reason":"Fixed: use echo -en instead of printf to properly interpret ANSI escape sequences","comments":[{"id":9,"issue_id":"csb-7x9","author":"danyel","text":"Regression from ce7fab1 (spinner refactor). The _spinner_loop uses printf %s which outputs ANSI codes literally instead of interpreting them. Other functions use echo -e which works correctly.","created_at":"2026-01-10T00:58:49Z"}]}
{"id":"csb-9ag","title":"Consider blocking IPv6 entirely for simplicity","description":"IPv6 rules are set up but AAAA resolution may miss some addresses. Blocking IPv6 entirely would simplify the security model.","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-09T15:29:12.983227-08:00","created_by":"danyel","updated_at":"2026-01-09T18:46:50.337232-08:00","closed_at":"2026-01-09T18:46:50.337232-08:00","close_reason":"wontfix - switched to DNS-based filtering which is simpler and handles IPv6 naturally"}
{"id":"csb-9cx","title":"Support parallel isolated agents with separate user IDs","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-09T22:08:37.795567-08:00","created_by":"danyel","updated_at":"2026-01-09T22:57:45.214401-08:00","closed_at":"2026-01-09T22:57:45.214401-08:00","close_reason":"Implemented: csb start \u003cagent\u003e with separate Linux users and kernel-enforced isolation","dependencies":[{"issue_id":"csb-9cx","depends_on_id":"csb-iv9","type":"blocks","created_at":"2026-01-09T22:09:05.686175-08:00","created_by":"danyel"}],"comments":[{"id":16,"issue_id":"csb-9cx","author":"danyel","text":"## Summary\nEnable `csb start \u003cagent-name\u003e` to create isolated parallel agents.\n\n## Design\n- Each agent gets its own Linux user (agent1, agent2, etc.)\n- Home directory chmod 700 for kernel-enforced isolation\n- Git repo cloned to ~/repo per agent\n- Claude cannot see other agents' directories even with --dangerously-skip-permissions\n\n## Implementation\n1. Dynamic user creation: `useradd -m -s /bin/bash \u003cagent-name\u003e`\n2. Clone repo on first start, git pull on subsequent starts\n3. tmux session per agent, running as that user\n4. System-wide git credential helper (depends on csb-iv9)\n\n## CLI Changes\n- `csb start \u003cagent-name\u003e` - start/attach to named agent\n- `csb list` - show all agent sessions\n- `csb stop \u003cagent-name\u003e` - stop agent session","created_at":"2026-01-10T06:08:54Z"}]}
{"id":"csb-9p8","title":"[TEST-5] Multi-agent test task 5","description":"Test task for Phase 3 multi-agent validation. Simple placeholder task.","status":"closed","priority":0,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T21:34:04.643737-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T21:51:58.871783-08:00","closed_at":"2026-01-11T21:51:58.871783-08:00","close_reason":"Test tasks for Phase 3 validation. Cleaning up."}
{"id":"csb-9vv","title":"Investigate why claude exits immediately on fresh VM","description":"## Problem\nWhen csb starts a fresh VM and launches claude, the claude process exits immediately before the user can attach. This was masked by the fix in csb-a66 (session now persists via bash + send-keys).\n\n## Questions to investigate\n1. Is the API key being passed correctly to the VM?\n2. Does claude need an interactive terminal to start?\n3. Is there a configuration issue on first run?\n4. What error does claude output when it exits?\n\n## How to debug\n- Check if ANTHROPIC_API_KEY is set in the VM environment\n- Run `claude` manually in the VM shell and observe output\n- Check claude's logs/config in ~/.claude/\n\n## Related\n- Fixed session persistence in csb-a66","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-09T14:49:01.893348-08:00","created_by":"danyel","updated_at":"2026-01-09T15:20:21.73486-08:00","closed_at":"2026-01-09T15:20:21.73486-08:00","close_reason":"Cannot reproduce - likely caused by missing ANTHROPIC_API_KEY at VM creation time"}
{"id":"csb-9xr","title":"Add csb logs command for debugging","description":"View cloud-init or provisioning logs without manually SSHing. Helps users debug VM provisioning issues.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-09T15:29:13.311458-08:00","created_by":"danyel","updated_at":"2026-01-09T18:39:57.828197-08:00","closed_at":"2026-01-09T18:39:57.828197-08:00","close_reason":"Added csb logs command"}
{"id":"csb-a66","title":"tmux session disappears before attach on startup","description":"## Problem\nRunning `csb start` completes VM creation and provisioning successfully, but the final tmux session attachment fails with 'no sessions'.\n\n## Output\n```\n[csb] Creating session: claude-1\n[csb] Attaching to claude-1...\nno sessions\n```\n\n## Root Cause\nIn `cmd_start()` (csb:427-438), the tmux session is created with `claude` as the initial command:\n\n```bash\ntmux new-session -d -s \"${session_name}\" -c /workspace \"claude\"\n```\n\nIf the `claude` process exits before the attach happens (race condition), tmux destroys the session since its only window's command has exited. The `if ! ...` check only verifies the creation command succeeded, not that the session persists.\n\n## Fix Options\n1. Create session with a shell wrapper: `bash -c 'claude; exec bash'`\n2. Verify session exists after creation, show useful error if it vanishes\n3. Add small delay and retry logic\n4. Use `tmux send-keys` instead of running claude as the session command","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T14:26:00.367598-08:00","created_by":"danyel","updated_at":"2026-01-09T14:44:07.13397-08:00","closed_at":"2026-01-09T14:44:07.13397-08:00","close_reason":"Verified fix: session persists and is attachable"}
{"id":"csb-ac8","title":"Enforce consistent agent-port mapping","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T22:09:44.867171-08:00","created_by":"danyel","updated_at":"2026-01-10T10:00:42.33607-08:00","closed_at":"2026-01-10T10:00:42.33607-08:00","close_reason":"Closed","dependencies":[{"issue_id":"csb-ac8","depends_on_id":"csb-9cx","type":"blocks","created_at":"2026-01-09T22:09:48.473054-08:00","created_by":"danyel"}],"comments":[{"id":19,"issue_id":"csb-ac8","author":"danyel","text":"Each agent that opens a vite instance should consistently go to the same port, rather than the next in line.\n\nThis ensures predictable URLs for each agent - agent 1 always gets 5173, agent 2 gets 5174, etc. Makes it easier to track which browser tab corresponds to which agent.","created_at":"2026-01-10T06:10:44Z"}]}
{"id":"csb-ahg","title":"[TEST] Add hello world comment to entrypoint.sh","description":"Test task for Phase 2 validation. Just add a comment to entrypoint.sh saying hello.","status":"closed","priority":0,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T21:06:57.209393-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T21:25:23.546642-08:00","closed_at":"2026-01-11T21:25:23.546642-08:00","close_reason":"Test task - used for Phase 2 validation. Deleting."}
{"id":"csb-aqe","title":"Remove dead settings.json deletion code","description":"Lines 533-535 in csb remove settings.json with comment about invalid permission syntax, but we always use --dangerously-skip-permissions anyway. Dead code from earlier approach.","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-09T19:55:28.560781-08:00","created_by":"danyel","updated_at":"2026-01-09T19:57:02.513321-08:00","closed_at":"2026-01-09T19:57:02.513321-08:00","close_reason":"Duplicate of csb-o9a (both about settings.json deletion)"}
{"id":"csb-b52","title":"Investigate beads install slowness","description":"## Findings\n\nBeads installed successfully in **809 milliseconds** - not the bottleneck.\n\nFull provisioning completed in 33 seconds:\n- Claude Code CLI: ~2s\n- Beads CLI: \u003c1s\n- All 4 plugin commands: ~6s total\n\nThe actual issue was `limactl start` not reporting \"running\" status to csb within the expected time, causing csb to timeout/fail even though the VM was fully provisioned and working.\n\n## Root cause\nNOT the beads install. Likely Lima status reporting or csb's status polling logic.\n\n## Evidence\n```\n+ npm install -g @beads/bd\nadded 1 package in 809ms\n```\n\nVM is running and all plugins installed successfully.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T16:56:22.624066-08:00","created_by":"danyel","updated_at":"2026-01-09T18:14:43.115463-08:00","closed_at":"2026-01-09T18:14:43.115463-08:00","close_reason":"Investigation complete - beads installs in \u003c1s, issue is Lima status detection"}
{"id":"csb-bh3","title":"[TEST-4] Multi-agent test task 4","description":"Test task for Phase 3 multi-agent validation. Simple placeholder task.","status":"closed","priority":0,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T21:34:04.541626-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T21:51:58.870651-08:00","closed_at":"2026-01-11T21:51:58.870651-08:00","close_reason":"Test tasks for Phase 3 validation. Cleaning up."}
{"id":"csb-bhj","title":"DRY: Plugin commands duplicated in setup script","description":"Plugin commands appear twice in the setup script heredoc - once in echo statements (lines 95-98) and again raw in CMDS heredoc (lines 102-106). If commands change, both places need updating. Fix: single source of truth, or delete the script entirely per YAGNI issue.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T15:24:14.404526-08:00","created_by":"danyel","updated_at":"2026-01-09T15:46:24.086125-08:00","closed_at":"2026-01-09T15:46:24.086125-08:00","close_reason":"Script removed, issues are moot","dependencies":[{"issue_id":"csb-bhj","depends_on_id":"csb-qhk","type":"blocks","created_at":"2026-01-09T15:24:22.094885-08:00","created_by":"danyel"}]}
{"id":"csb-bkz","title":"Lost npm error output in beads install warning","description":"When beads CLI install fails, the CSB_WARN message just says 'install failed' without the actual npm error. Users don't know why (network? package not found?). Fix: capture stderr and include relevant details in the warning message.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-09T15:24:14.600859-08:00","created_by":"danyel","updated_at":"2026-01-09T19:59:18.555662-08:00","closed_at":"2026-01-09T19:59:18.555662-08:00","close_reason":"Fixed - plugins now install on first interactive login via .bashrc"}
{"id":"csb-bvf","title":"claude starts without beads or superpowers","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:58:31.948823-08:00","created_by":"danyel","updated_at":"2026-01-09T18:17:21.423026-08:00","closed_at":"2026-01-09T18:17:21.423026-08:00","close_reason":"Plugins work - this VM predates current template. Marketplaces were added but plugins weren't installed. Manual install worked fine.","comments":[{"id":8,"issue_id":"csb-bvf","author":"danyel","text":"Previous approach (commit c96feb5) manually constructed plugin JSON files which was fragile and was reverted.\n\nNew approach: Use official claude plugin CLI commands during provisioning:\n- claude plugin marketplace add steveyegge/beads\n- claude plugin marketplace add obra/superpowers-marketplace\n- claude plugin install beads@beads-marketplace\n- claude plugin install superpowers@superpowers-marketplace\n\nThis uses the official plugin installation mechanism which should handle versioning and paths correctly.\n\nManual instructions are still shown in .bashrc as fallback if auto-install fails.\n\nTo test: Destroy and recreate the VM (csb destroy \u0026\u0026 csb start)","created_at":"2026-01-09T23:49:03Z"}]}
{"id":"csb-c8q","title":"code review","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T15:16:22.154654-08:00","created_by":"danyel","updated_at":"2026-01-09T15:24:22.219736-08:00","closed_at":"2026-01-09T15:24:22.219736-08:00","close_reason":"Code review complete - created 5 issues for findings"}
{"id":"csb-cai","title":"Implement conflict escalation logic","description":"When agent cannot resolve merge conflict: add comment explaining the conflict, mark task as blocked, move on to next task. Escalate after N push retries fail.","status":"closed","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T15:26:11.463032-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T22:19:06.800598-08:00","closed_at":"2026-01-11T22:19:06.800598-08:00","close_reason":"Implemented conflict escalation with detailed comments for merge conflicts, test failures, push failures, and other error scenarios","dependencies":[{"issue_id":"csb-cai","depends_on_id":"csb-n6n","type":"blocks","created_at":"2026-01-11T15:26:29.896624-08:00","created_by":"danyel fisher"}]}
{"id":"csb-cov","title":"Bug: Silent failure on tmux session creation","description":"Line 264 suppresses all errors: 'limactl shell ... 2\u003e/dev/null || true'. If tmux session creation fails, user gets no feedback before the attach attempt fails with a confusing error.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T11:48:56.666257-08:00","created_by":"danyel","updated_at":"2026-01-09T13:52:50.128237-08:00","closed_at":"2026-01-09T13:52:50.128237-08:00","close_reason":"Closed"}
{"id":"csb-cu8","title":"GitHub token in .env lacks push permission","description":"During Phase 1 manual testing, the GITHUB_TOKEN in .env returned 403 on push to danyelf/claude-sandbox-maker.git. Need to regenerate token with repo write access or use a different auth method.","status":"closed","priority":2,"issue_type":"bug","owner":"danyel@gmail.com","created_at":"2026-01-11T20:54:58.437428-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T22:15:30.451307-08:00","closed_at":"2026-01-11T22:15:30.451307-08:00","close_reason":"Verified: GITHUB_TOKEN in .env authenticates as danyelf and has push access to claude-sandbox-maker","comments":[{"id":23,"issue_id":"csb-cu8","author":"danyel fisher","text":"OAuth token (CLAUDE_CODE_OAUTH_TOKEN) returns 401 'Invalid bearer token'. Token may be expired. See https://github.com/anthropics/claude-code/issues/12447 for token expiration issues. Workaround: use ANTHROPIC_API_KEY instead.","created_at":"2026-01-12T05:25:35Z"},{"id":24,"issue_id":"csb-cu8","author":"danyel fisher","text":"Tested token from .env - returns 'Bad credentials'. Token is 93 chars, starts with github_pat_ (correct fine-grained format), but fails all auth methods. User needs to verify token is valid and not expired.","created_at":"2026-01-12T06:10:01Z"}]}
{"id":"csb-cuq","title":"Low default VM resources may be insufficient","description":"Default 2 CPUs / 2GiB RAM may be tight for Claude Code + npm builds. Consider increasing defaults or documenting how to adjust via 'csb config'.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T11:49:02.289637-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.207227-08:00","closed_at":"2026-01-09T12:07:16.105793-08:00","close_reason":"Bumped defaults to 4 CPUs, 4GiB RAM, 30GiB disk"}
{"id":"csb-d1f","title":"Create build-template.sh script","description":"Create a build script that assembles template.yaml from template.yaml.in and external files.\n\n## Requirements\n- Read template.yaml.in with placeholders like {{SCRIPT_PACKAGES}}, {{SCRIPT_USER_SETUP}}, etc.\n- Inject contents of provision/*.sh scripts\n- Inject config files where needed\n- Output final template.yaml\n- Validate scripts with shellcheck before building (optional, warn on failure)\n\n## Notes\n- Keep it simple - bash script is fine\n- Should be idempotent\n- Consider adding to Makefile or pre-commit hook","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T20:12:22.064903-08:00","created_by":"danyel","updated_at":"2026-01-09T20:47:24.410699-08:00","closed_at":"2026-01-09T20:47:24.410699-08:00","close_reason":"Closed","dependencies":[{"issue_id":"csb-d1f","depends_on_id":"csb-0sq","type":"parent-child","created_at":"2026-01-09T20:12:33.274099-08:00","created_by":"danyel"},{"issue_id":"csb-d1f","depends_on_id":"csb-5rc","type":"blocks","created_at":"2026-01-09T20:13:17.030113-08:00","created_by":"danyel"}]}
{"id":"csb-d3v","title":"csb start times out even when VM provisions successfully","description":"## Problem\n`csb start` reports timeout/failure even when the VM provisions successfully.\n\nError message:\n```\ndid not receive an event with the \"running\" status\n```\n\nBut the VM is actually running and fully provisioned (verified via `limactl list` and cloud-init logs).\n\n## Evidence\n- Cloud-init completed in 33 seconds\n- All packages and plugins installed successfully\n- VM is Running according to `limactl list`\n- No tmux session created because csb exited before that step\n\n## Likely cause\nThe csb start_vm polling loop or Lima's status reporting doesn't align with when cloud-init actually completes.\n\n## Location\n`csb/csb` - start_vm function, status polling logic","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-09T18:14:51.98509-08:00","created_by":"danyel","updated_at":"2026-01-09T18:22:14.640042-08:00","closed_at":"2026-01-09T18:22:14.640042-08:00","close_reason":"Fixed: check VM status on limactl timeout","dependencies":[{"issue_id":"csb-d3v","depends_on_id":"csb-xlp","type":"related","created_at":"2026-01-09T18:15:41.958383-08:00","created_by":"danyel"}]}
{"id":"csb-dds","title":"Extract user setup script (02-user-setup.sh)","description":"Extract the user-mode provision block to a separate script.\n\n## Current location\ntemplate.yaml lines 65-148\n\n## Extract to\ncsb/provision/02-user-setup.sh\n\n## Contents\n- npm global config\n- Claude Code CLI install\n- Beads CLI install (with diagnostics)\n- Plugin installer bashrc injection\n\n## Cleanup opportunities\n- Consider moving first-login plugin script to separate file\n- Beads install diagnostics could be a function or separate script\n- Keep CSB_PROGRESS and CSB_WARN markers","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T20:12:22.535252-08:00","created_by":"danyel","updated_at":"2026-01-09T20:21:15.624214-08:00","closed_at":"2026-01-09T20:21:15.624214-08:00","close_reason":"Extracted to csb/provision/02-user-setup.sh with shellcheck directives","dependencies":[{"issue_id":"csb-dds","depends_on_id":"csb-0sq","type":"parent-child","created_at":"2026-01-09T20:12:33.372691-08:00","created_by":"danyel"}]}
{"id":"csb-e3k","title":"Show provisioning progress during startup","description":"During VM startup, show which tools are being provisioned and general progress. Currently just shows a spinner with no indication of what's happening inside the VM.\n\nIdeas:\n- Show stages: 'Installing base packages...', 'Installing Claude Code...', 'Configuring YOLO mode...'\n- Could tail cloud-init logs from the VM\n- Show percentage or step count (e.g., 'Step 2/5: Installing nodejs...')","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-09T11:39:34.185684-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.205019-08:00","closed_at":"2026-01-09T12:06:50.515438-08:00","close_reason":"Implemented provisioning progress display with CSB_PROGRESS markers and SSH polling"}
{"id":"csb-fip","title":"Remove hope-based Claude initialization (claude --version + sleep 1)","description":"template.yaml:117-120 runs 'claude --version' then 'sleep 1' hoping it initializes Claude's internal state. No verification. Either remove if unnecessary, or add proper check.","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-09T19:55:58.048332-08:00","created_by":"danyel","updated_at":"2026-01-09T20:08:13.288768-08:00","closed_at":"2026-01-09T20:08:13.288768-08:00","close_reason":"Closed"}
{"id":"csb-fqa","title":"Agents don't see installed material from golden image (claude, plugins, python)","description":"Agent users created via `csb start agent1` don't have access to software installed in the golden image:\n- Claude CLI\n- npm plugins\n- Python packages\n\nThis is because agent users are separate Linux users with their own home directories, and the tools were installed for the `ubuntu` user.\n\nMay need an architectural rethink:\n- Option 1: Install tools system-wide instead of per-user\n- Option 2: Share /home/ubuntu/.npm-global and other paths with agent users\n- Option 3: Use symlinks from agent home to ubuntu's installed tools\n- Option 4: Different isolation model (containers instead of users?)","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-10T10:29:00.878704-08:00","created_by":"danyel","updated_at":"2026-01-10T10:48:18.98797-08:00","closed_at":"2026-01-10T10:48:18.98797-08:00","close_reason":"Closed"}
{"id":"csb-fzp","title":"Test parallel isolated agents (csb-9cx)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T22:57:23.030188-08:00","created_by":"danyel","updated_at":"2026-01-09T23:09:33.933038-08:00","closed_at":"2026-01-09T23:09:33.933038-08:00","close_reason":"Tested parallel agents: user isolation (chmod 700), git cloning, session listing (fixed bug), attach verified. Committed fix for csb list.","dependencies":[{"issue_id":"csb-fzp","depends_on_id":"csb-9cx","type":"blocks","created_at":"2026-01-09T22:57:27.224986-08:00","created_by":"danyel"}]}
{"id":"csb-g31","title":"Template cached forever, updates not picked up","description":"create_vm only copies template.yaml to ~/.csb/ if it doesn't exist. This means template updates are never picked up for subsequent VM creations.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-09T18:25:20.355463-08:00","created_by":"danyel","updated_at":"2026-01-09T18:25:26.804018-08:00","closed_at":"2026-01-09T18:25:26.804018-08:00","close_reason":"Always copy latest template on VM creation"}
{"id":"csb-g3j","title":"[TEST-1] Multi-agent test task 1","description":"Test task for Phase 3 multi-agent validation. Simple placeholder task.","status":"closed","priority":0,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T21:34:04.25877-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T21:51:58.866691-08:00","closed_at":"2026-01-11T21:51:58.866691-08:00","close_reason":"Test tasks for Phase 3 validation. Cleaning up."}
{"id":"csb-grz","title":"Create Docker Model for Multi-Agent Workflow","description":"Parent epic for multi-agent Docker workflow implementation. See docs/plans/2026-01-11-multi-agent-workflow-design.md. Goal: Run 4-6 Claude agents on same codebase in Docker containers with shared volume for Beads coordination and worktree isolation.","status":"closed","priority":1,"issue_type":"epic","owner":"danyel@gmail.com","created_at":"2026-01-11T15:25:47.33993-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T15:31:26.373362-08:00","closed_at":"2026-01-11T15:31:26.373362-08:00","close_reason":"Docker model implementation complete: Dockerfile, docker-compose.yml, entrypoint.sh created in docker/"}
{"id":"csb-gz0","title":"Add flag for less frequent progress updates during testing","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-10T10:43:58.255884-08:00","created_by":"danyel","updated_at":"2026-01-10T10:47:52.46142-08:00","closed_at":"2026-01-10T10:47:52.46142-08:00","close_reason":"Added --slow-progress flag (commit a3be097)","comments":[{"id":21,"issue_id":"csb-gz0","author":"danyel","text":"## Summary\nAdd a flag to reduce the frequency of progress updates during VM provisioning.\n\n## Why\nWhen testing, the frequent progress polling burns tokens in agent conversations. A less frequent update mode would reduce costs during development/testing.\n\n## Suggestion\nAdd --quiet or --slow-progress flag that increases the sleep interval in the progress polling loop.","created_at":"2026-01-10T18:44:07Z"}]}
{"id":"csb-h4y","title":"Security: IP allowlist becomes stale after provisioning","description":"## Problem\n\nDomain IPs are resolved only at provisioning time. If CDNs or services change their IP addresses after the VM is provisioned, connectivity breaks silently.\n\n## Impact\n\n- Outbound connections to allowed domains may fail unexpectedly\n- No mechanism exists to refresh the IP allowlist\n- Users may not realize the issue is stale IPs vs. a configuration problem\n\n## Location\n\nFile: `template.yaml:179-194`\n\n## Recommendation\n\n- Implement periodic refresh of resolved IPs (e.g., cron job or systemd timer)\n- Alternatively, use a transparent proxy that resolves domains dynamically","status":"closed","priority":4,"issue_type":"bug","created_at":"2026-01-09T15:29:09.519947-08:00","created_by":"danyel","updated_at":"2026-01-09T18:45:43.570454-08:00","closed_at":"2026-01-09T18:45:43.570454-08:00","close_reason":"Won't fix: security hardening deferred"}
{"id":"csb-hai","title":"Create Dockerfile for agent containers","description":"Create Ubuntu-based Dockerfile with git, nodejs, npm, jq, claude-code, and beads-cli. See docs/plans/2026-01-11-multi-agent-workflow-design.md Container Setup section.","status":"closed","priority":1,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T15:26:10.495133-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T15:31:10.219296-08:00","closed_at":"2026-01-11T15:31:10.219296-08:00","close_reason":"Implementation complete - files created in docker/"}
{"id":"csb-hi8","title":"Extract dnsmasq allowlist to config file","description":"Move the dnsmasq domain allowlist to a separate, easily-editable config file.\n\n## Current location\ntemplate.yaml lines 167-221 (embedded in heredoc)\n\n## Extract to\ncsb/config/dnsmasq-allowlist.conf\n\n## Bonus: allowed-domains.txt\nConsider a simple text file with just domain names:\n```\n# Package managers\npypi.org\npythonhosted.org\nnpmjs.org\n...\n```\n\nThen generate the dnsmasq config from this list. This makes adding domains trivial.\n\n## Benefits\n- Easy to review/audit allowed domains\n- Simple to add new domains\n- Could be shared with documentation","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T20:12:23.014774-08:00","created_by":"danyel","updated_at":"2026-01-09T20:25:56.133081-08:00","closed_at":"2026-01-09T20:25:56.133081-08:00","close_reason":"Closed","dependencies":[{"issue_id":"csb-hi8","depends_on_id":"csb-0sq","type":"parent-child","created_at":"2026-01-09T20:12:33.469544-08:00","created_by":"danyel"}]}
{"id":"csb-i0d","title":"Add csb snapshot command to capture provisioned VM state","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-09T19:46:17.360153-08:00","created_by":"danyel","updated_at":"2026-01-09T20:34:37.927881-08:00","closed_at":"2026-01-09T20:34:37.927881-08:00","close_reason":"All subtasks complete: create/start/snapshot commands implemented","dependencies":[{"issue_id":"csb-i0d","depends_on_id":"csb-7fw","type":"blocks","created_at":"2026-01-09T20:19:26.004474-08:00","created_by":"danyel"}],"comments":[{"id":10,"issue_id":"csb-i0d","author":"danyel","text":"## Goal\n\nSkip slow/flaky provisioning by reusing a pre-provisioned disk image.\n\n## Implementation\n\n1. `csb snapshot` - Flatten current VM's disk to `~/.csb/golden.qcow2`:\n   ```bash\n   limactl stop $vm\n   qemu-img convert -O qcow2 ~/.lima/$vm/diffdisk ~/.csb/golden.qcow2\n   ```\n\n2. `csb start` - Detect golden image and use it:\n   - Generate lima.yaml with correct workspace mount + API key\n   - Point to golden.qcow2 instead of base Debian\n   - Skip provisioning scripts (already baked in)\n\n## Notes\n\n- Architecture-specific (arm64 vs x86_64)\n- Workspace mount handled at runtime by Lima, not baked in disk\n- DNS-based network filtering (dnsmasq) means no stale IP issues","created_at":"2026-01-10T03:46:24Z"},{"id":12,"issue_id":"csb-i0d","author":"danyel","text":"## Refined Design\n\n**Command behavior:**\n\n| Command | No VM exists | VM exists (stopped) | VM exists (running) |\n|---------|--------------|---------------------|---------------------|\n| csb create | Provision from scratch | Start + tmux attach | tmux attach |\n| csb start | Use golden image (error if missing) | Start + tmux attach | tmux attach |\n| csb shell | Error | Start + plain shell | Plain shell |\n| csb snapshot | Error | Stop + snapshot disk | Stop + snapshot disk |\n\n**Implementation:**\n1. Rename cmd_start to cmd_create\n2. New cmd_start - uses ~/.csb/golden-$(uname -m).qcow2, errors if missing\n3. New cmd_snapshot - stops VM, runs qemu-img convert to flatten disk\n4. cmd_shell - unchanged\n\n**Decisions:**\n- csb start with no golden image = error (not fallback)\n- csb snapshot always overwrites (no --force needed)\n- Golden images are arch-specific","created_at":"2026-01-10T04:16:18Z"}]}
{"id":"csb-ic5","title":"DRY up duplicate warning display code in start_vm","description":"Lines 427-435 and 452-460 have duplicate warning display logic. Extract to helper function.","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-09T19:55:28.846745-08:00","created_by":"danyel","updated_at":"2026-01-09T20:38:29.962078-08:00","closed_at":"2026-01-09T20:38:29.962078-08:00","close_reason":"Closed"}
{"id":"csb-iv9","title":"Add GITHUB_TOKEN for git credentials","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-09T22:08:37.939502-08:00","created_by":"danyel","updated_at":"2026-01-09T22:35:52.703381-08:00","closed_at":"2026-01-09T22:35:52.703381-08:00","close_reason":"Implemented: GITHUB_TOKEN env var + system-wide git credential helper","comments":[{"id":17,"issue_id":"csb-iv9","author":"danyel","text":"## Summary\nAdd GITHUB_TOKEN environment variable for git authentication via HTTPS credential helper.\n\n## Why\n- Enables parallel agents (each with separate user ID) to authenticate to git\n- SSH agent forwarding doesn't work across sudo -u boundaries\n- Single token works for any number of dynamically created agent users\n\n## Implementation\n1. Template: Add GITHUB_TOKEN to env section (like ANTHROPIC_API_KEY)\n2. Provisioning: Store token in /etc/csb/git-credentials\n3. Git config: System-wide credential helper pointing to that file\n4. Permissions: 644 so all users can read\n\n## Config\n```yaml\nenv:\n  GITHUB_TOKEN: \"{{GITHUB_TOKEN}}\"\n```\n\n```bash\necho \"https://oauth2:${GITHUB_TOKEN}@github.com\" \u003e /etc/csb/git-credentials\ngit config --system credential.helper \"store --file=/etc/csb/git-credentials\"\n```","created_at":"2026-01-10T06:09:01Z"}]}
{"id":"csb-iw2","title":"Lima boot script fails with 'already mounted' error","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T19:58:31.17045-08:00","created_by":"danyel","updated_at":"2026-01-09T20:12:58.899084-08:00","closed_at":"2026-01-09T20:12:58.899084-08:00","close_reason":"Cannot reproduce: investigated VM logs, restart cycles, and Lima boot scripts but found no 'already mounted' error. Only boot failure found is resolvconf issue (csb-nn0)."}
{"id":"csb-jhy","title":"Extract network restrictions script (03-network.sh)","description":"Extract the network/firewall provision block to a separate script.\n\n## Current location\ntemplate.yaml lines 150-316\n\n## Extract to\ncsb/provision/03-network.sh\n\n## Contents\n- dnsmasq configuration (should reference external config)\n- iptables rules setup\n- systemd service for iptables persistence\n\n## Dependencies\n- Should source/read csb/config/dnsmasq-allowlist.conf\n- Or: build step injects the config inline","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T20:12:22.747414-08:00","created_by":"danyel","updated_at":"2026-01-09T20:35:58.529675-08:00","closed_at":"2026-01-09T20:35:58.529675-08:00","close_reason":"Closed","dependencies":[{"issue_id":"csb-jhy","depends_on_id":"csb-0sq","type":"parent-child","created_at":"2026-01-09T20:12:33.422149-08:00","created_by":"danyel"},{"issue_id":"csb-jhy","depends_on_id":"csb-hi8","type":"blocks","created_at":"2026-01-09T20:13:19.362247-08:00","created_by":"danyel"}]}
{"id":"csb-koh","title":"Remove duplicated network rules (DRY violation)","description":"## Problem\n`template.yaml:138-262` duplicates `network-rules.sh` almost verbatim (~130 lines).\nThis is a maintenance hazard - updating the domain list requires changes in two places.\n\n## Solution\nEither:\n1. Remove `network-rules.sh` entirely (appears unused), OR\n2. Have the template source the external script instead of duplicating\n\n## Files\n- `csb/template.yaml`\n- `csb/network-rules.sh`","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T15:37:11.087037-08:00","created_by":"danyel","updated_at":"2026-01-09T15:42:56.316163-08:00","closed_at":"2026-01-09T15:42:56.316163-08:00","close_reason":"Closed"}
{"id":"csb-kva","title":"Add interactive mode support","description":"Support --mode flag for interactive vs autonomous. Interactive mode: human picks task, port mapping for dev servers (agent1:5181, agent2:5182, etc), continuous feedback loop, merge on human approval.","status":"open","priority":3,"issue_type":"epic","owner":"danyel@gmail.com","created_at":"2026-01-11T15:26:11.620121-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:38:38.839095-08:00","dependencies":[{"issue_id":"csb-kva","depends_on_id":"csb-0b9","type":"blocks","created_at":"2026-01-11T15:26:30.03188-08:00","created_by":"danyel fisher"}],"comments":[{"id":25,"issue_id":"csb-kva","author":"danyel fisher","text":"Design document created: docs/plans/2026-01-11-interactive-mode-design.md","created_at":"2026-01-12T07:33:45Z"}]}
{"id":"csb-l8l","title":"Phase 3: Approval UI","description":"Add approval handling to dashboard: detect needs_approval status, show approval dialog with diff summary/commit msg/test results, handle approve/reject keypresses, write approval response file.\n\nTesting:\n- Unit test approval dialog renders correctly\n- Test approve action writes 'approved' to response file\n- Test reject action writes 'rejected' to response file\n- Integration test: agent detects approval response and proceeds","status":"open","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:38:14.573958-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:47:02.884236-08:00","dependencies":[{"issue_id":"csb-l8l","depends_on_id":"csb-lgq","type":"blocks","created_at":"2026-01-11T23:38:20.914848-08:00","created_by":"danyel fisher"},{"issue_id":"csb-l8l","depends_on_id":"csb-kva","type":"parent-child","created_at":"2026-01-11T23:38:34.576381-08:00","created_by":"danyel fisher"}]}
{"id":"csb-lgq","title":"Phase 2: Basic dashboard (host-side)","description":"Standalone Python + Textual app on host Mac. Create csb-dashboard command, poll /workspace/.csb/*/status files, display agent panels and task bar, implement keyboard navigation.\n\nTesting:\n- Unit test status file parsing\n- Unit test Textual widgets render correctly\n- Test keyboard navigation (arrows, tab, enter)\n- Test polling updates UI when files change\n- Manual test: run with mock status files","status":"open","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:38:14.405916-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:47:02.74322-08:00","dependencies":[{"issue_id":"csb-lgq","depends_on_id":"csb-yoo","type":"blocks","created_at":"2026-01-11T23:38:20.851235-08:00","created_by":"danyel fisher"},{"issue_id":"csb-lgq","depends_on_id":"csb-kva","type":"parent-child","created_at":"2026-01-11T23:38:34.575445-08:00","created_by":"danyel fisher"}]}
{"id":"csb-lkn","title":"Document --dangerously-skip-permissions usage in help","description":"The --dangerously-skip-permissions flag is always used but not documented in the help output.\n\nDetails:\n- The flag is currently hardcoded and always passed to codesandbox commands\n- Should be mentioned in the help output so users understand this behavior\n- Consider making it configurable (e.g., allow users to opt-out)\n- Location: csb:448","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T15:29:07.910253-08:00","created_by":"danyel","updated_at":"2026-01-09T16:44:11.236843-08:00","closed_at":"2026-01-09T16:44:11.236843-08:00","close_reason":"Closed"}
{"id":"csb-m0g","title":"[TEST-6] Multi-agent test task 6","description":"Test task for Phase 3 multi-agent validation. Simple placeholder task.","status":"closed","priority":0,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T21:34:04.741761-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T21:51:58.872854-08:00","closed_at":"2026-01-11T21:51:58.872854-08:00","close_reason":"Test tasks for Phase 3 validation. Cleaning up."}
{"id":"csb-msv","title":"bd command not available in shell","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T14:58:42.82055-08:00","created_by":"danyel","updated_at":"2026-01-09T15:03:30.85675-08:00","closed_at":"2026-01-09T15:03:30.85675-08:00","close_reason":"Closed"}
{"id":"csb-n6n","title":"Create entrypoint.sh script with agent loop","description":"Agent loop: 1) bd ready 2) bd update --status in_progress 3) git worktree add 4) do work 5) git rebase 6) test 7) ff-only merge \u0026 push 8) cleanup. Handle failures by marking blocked.","status":"closed","priority":1,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T15:26:10.817901-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T15:31:10.221934-08:00","closed_at":"2026-01-11T15:31:10.221934-08:00","close_reason":"Implementation complete - files created in docker/"}
{"id":"csb-nb5","title":"Agent git clone fails: SSH keys not available to agent users","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-10T10:09:26.991014-08:00","created_by":"danyel","updated_at":"2026-01-10T10:25:19.427013-08:00","closed_at":"2026-01-10T10:25:19.427013-08:00","close_reason":"Closed","comments":[{"id":20,"issue_id":"csb-nb5","author":"danyel","text":"When starting an agent with `csb start agent1`, git clone fails:\n\n```\ngit@github.com: Permission denied (publickey).\nfatal: Could not read from remote repository.\n```\n\nThe issue is that each agent runs as its own Linux user, and SSH keys are not available to that user.\n\n**Options:**\n1. Convert SSH URLs to HTTPS and use GITHUB_TOKEN for auth\n2. Copy host's SSH keys to agent user (security concern)\n3. Use SSH agent forwarding (already enabled in template, but may not work for sudo -u)\n\nOption 1 is probably cleanest - detect SSH URLs and convert to HTTPS format, then configure git to use GITHUB_TOKEN for auth.","created_at":"2026-01-10T18:09:41Z"}]}
{"id":"csb-nn0","title":"DNS-based filtering: resolvconf fails on loopback interface","description":"## Problem\n\nThe DNS-based network filtering setup fails when trying to configure resolv.conf:\n\n```\n+ resolvconf -a lo.dnsmasq\nDropped protocol specifier '.dnsmasq' from 'lo.dnsmasq'. Using 'lo' (ifindex=1).\nFailed to set DNS configuration: Link lo is loopback device.\n```\n\n## Current Behavior\n\n- dnsmasq is installed and configured with domain allowlist\n- But system DNS still points to Lima's default (192.168.5.2) instead of localhost\n- Network filtering partially works but not as intended\n\n## Expected Behavior\n\n- /etc/resolv.conf should point to 127.0.0.1 (dnsmasq)\n- All DNS queries go through dnsmasq which only resolves allowed domains\n\n## Fix Options\n\n1. Write directly to /etc/resolv.conf instead of using resolvconf\n2. Configure systemd-resolved to use dnsmasq as upstream\n3. Use a different method to set DNS (netplan, /etc/network/interfaces)\n\n## Location\n\ntemplate.yaml network restrictions section (provision.system script)","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-09T20:01:03.78388-08:00","created_by":"danyel","updated_at":"2026-01-09T20:19:01.213515-08:00","closed_at":"2026-01-09T20:19:01.213515-08:00","close_reason":"No repro"}
{"id":"csb-nt9","title":"Still asks 'do you want to create the instance now'","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T13:06:09.399803-08:00","created_by":"danyel","updated_at":"2026-01-09T14:54:44.084136-08:00","closed_at":"2026-01-09T14:54:44.084136-08:00","close_reason":"Added --tty=false to limactl start (lines 305, 321)"}
{"id":"csb-nwc","title":"Add validation for workspace path special characters","description":"Workspace path not validated for special characters. Could cause issues with shell commands. File: csb:198","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T15:29:06.705819-08:00","created_by":"danyel","updated_at":"2026-01-09T18:30:36.154434-08:00","closed_at":"2026-01-09T18:30:36.154434-08:00","close_reason":"Won't fix: paths with quotes would break YAML, but this edge case is extremely rare. Users with special chars in paths already deal with broad tooling issues."}
{"id":"csb-nx7","title":"Update csb to look for support files in /usr/local/share/csb","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T20:59:43.203092-08:00","created_by":"danyel","updated_at":"2026-01-09T21:14:31.153961-08:00","closed_at":"2026-01-09T21:14:31.153961-08:00","close_reason":"Already implemented","comments":[{"id":13,"issue_id":"csb-nx7","author":"danyel","text":"Look for template.yaml and support files in:\n1. $CSB_SHARE_DIR (env override)\n2. /usr/local/share/csb/ (system install)\n3. Same directory as script (dev/clone install)\n\nFiles needed: template.yaml, provision/*.sh, config/allowed-domains.txt","created_at":"2026-01-10T05:00:04Z"}]}
{"id":"csb-o9a","title":"Remove duplicate settings.json deletion","description":"settings.json is deleted in BOTH template.yaml:112-113 (during provisioning) AND csb:533-535 (when starting session). Pick one location. Since we always use --dangerously-skip-permissions, probably don't need either.","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-09T19:55:58.201398-08:00","created_by":"danyel","updated_at":"2026-01-09T20:14:53.346182-08:00","closed_at":"2026-01-09T20:14:53.346182-08:00","close_reason":"Closed","comments":[{"id":11,"issue_id":"csb-o9a","author":"danyel","text":"Also covers csb-aqe (merged). Remove settings.json deletion from BOTH locations since we always use --dangerously-skip-permissions.","created_at":"2026-01-10T03:57:02Z"}]}
{"id":"csb-p3e","title":"noisy spew when I start csb shell","description":"When running `csb shell` from a host directory, get errors:\n\n```\n[csb] VM already running\nbash: line 1: cd: /Users/danyel/code/MISC/torahmap2: No such file or directory\nbash: line 1: cd: /Users/danyel: No such file or directory\n/bin/bash: --: invalid option\n```\n\nThe shell script is trying to cd to the host path which doesn't exist in the VM, then falling back and still failing, and finally passing invalid options to bash.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T15:21:09.491371-08:00","created_by":"danyel","updated_at":"2026-01-09T15:24:11.086629-08:00","closed_at":"2026-01-09T15:24:11.086629-08:00","close_reason":"Fixed argument order in limactl shell call - flags must come before VM name in Lima 2.0"}
{"id":"csb-qbm","title":"Move beads install diagnostics to only run on failure","description":"template.yaml:82-96 runs heavyweight network diagnostics (dig, curl x3) BEFORE every beads install attempt. This wastes time when install succeeds. Move diagnostics to only run when install fails.","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-09T19:55:58.342953-08:00","created_by":"danyel","updated_at":"2026-01-09T20:40:58.109381-08:00","closed_at":"2026-01-09T20:40:58.109381-08:00","close_reason":"Closed"}
{"id":"csb-qf9","title":"errors on starting claude","description":"Old settings.json with invalid permission syntax (Bash(*), WebFetch(*), etc) causes startup error. Since we use --dangerously-skip-permissions, we should remove any existing settings.json.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-09T14:56:19.820616-08:00","created_by":"danyel","updated_at":"2026-01-09T15:32:03.68893-08:00","closed_at":"2026-01-09T15:32:03.68893-08:00","close_reason":"Now removes settings files from both VM home AND workspace mount (/workspace/.claude/)","comments":[{"id":4,"issue_id":"csb-qf9","author":"danyel","text":"Fix only runs during cloud-init provisioning (first boot). Existing VMs created before this fix still have the old settings.json. Options: (1) Remove settings.json at runtime in csb script before launching claude, or (2) Document that users need to destroy/recreate VMs. Option 1 is better UX.","created_at":"2026-01-09T23:28:41Z"},{"id":5,"issue_id":"csb-qf9","author":"danyel","text":"Root cause is different: .claude/settings.local.json exists in the WORKSPACE (host-mounted at /workspace), not in VM home. This persists across VM destroy. The file also has corrupted entries (commit messages leaked into permission strings at lines 27, 29). Fix needs to also remove /workspace/.claude/settings*.json","created_at":"2026-01-09T23:31:50Z"},{"id":6,"issue_id":"csb-qf9","author":"danyel","text":"Reverted overkill fix. The issue was a corrupted .claude/settings.local.json in the workspace. Deleted it locally instead of removing on every start.","created_at":"2026-01-09T23:33:07Z"},{"id":7,"issue_id":"csb-qf9","author":"danyel","text":"Root cause: tilde expansion. The ~ in 'rm -f ~/.claude/settings.json' was expanded by the HOST shell before limactl passed it to the VM. Fixed by using bash -c with single-quoted $HOME.","created_at":"2026-01-09T23:39:53Z"}]}
{"id":"csb-qhk","title":"YAGNI: Remove unnecessary csb-setup-plugins script","description":"The ~/.csb-setup-plugins script just echoes plugin commands. The bashrc reminder could show these directly - no need for a separate script. Current: reminder → run script → see commands → copy. Simpler: reminder shows commands → copy. Delete the script and inline the commands in the bashrc reminder.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T15:24:14.159562-08:00","created_by":"danyel","updated_at":"2026-01-09T15:46:24.084032-08:00","closed_at":"2026-01-09T15:46:24.084032-08:00","close_reason":"Script removed, issues are moot"}
{"id":"csb-qk3","title":"Security: DNS traffic allows exfiltration to any server","description":"## Issue\n\nDNS traffic (port 53 UDP/TCP) is currently allowed to any destination, which creates a data exfiltration vector. Malicious code could use DNS tunneling to exfiltrate sensitive data to attacker-controlled DNS servers.\n\n## Location\n\nFile: template.yaml:211-214\n\n## Recommendation\n\nRestrict DNS traffic to specific trusted resolvers only:\n- 8.8.8.8 (Google DNS)\n- 8.8.4.4 (Google DNS)\n\nThis limits the attack surface by preventing DNS queries to arbitrary servers.","status":"closed","priority":4,"issue_type":"bug","created_at":"2026-01-09T15:29:08.563765-08:00","created_by":"danyel","updated_at":"2026-01-09T18:45:43.568729-08:00","closed_at":"2026-01-09T18:45:43.568729-08:00","close_reason":"Won't fix: security hardening deferred"}
{"id":"csb-qnv","title":"Improve startup feedback - reduce verbose Lima messages","description":"At startup, it takes a while with minimal progress. Displays lots of messages like 'INFO[0045] [hostagent] Waiting for the optional requirement 1 of 1: \"user probe 1/1\"'. Need better user feedback during VM creation/startup.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T11:06:21.589273-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.205268-08:00","closed_at":"2026-01-09T11:08:21.30904-08:00","close_reason":"Added spinner with progress feedback, suppresses verbose Lima output by default. Use --verbose flag or CSB_VERBOSE=true to see full output."}
{"id":"csb-r8e","title":"add timing for each step of the csb process","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T13:07:37.882877-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.202809-08:00","closed_at":"2026-01-09T13:12:41.307799-08:00","close_reason":"Added live timing display to csb spinners"}
{"id":"csb-rio","title":"Add progressive timing information to csb startup. Let me see how much progress it has made","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-09T13:17:22.557049-08:00","created_by":"danyel","updated_at":"2026-01-09T13:21:20.308508-08:00","closed_at":"2026-01-09T13:21:20.308508-08:00","close_reason":"Added progressive timing to start_vm and create_vm functions"}
{"id":"csb-rxn","title":"Misleading spinner message for VM creation","description":"Line 191 says 'Downloading VM image' but limactl create does much more (configures VM, sets up mounts, etc.). Message should reflect the full operation.","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-09T11:49:01.927338-08:00","created_by":"danyel","updated_at":"2026-01-09T19:59:18.557102-08:00","closed_at":"2026-01-09T19:59:18.557102-08:00","close_reason":"Fixed - plugins now install on first interactive login via .bashrc"}
{"id":"csb-t5u","title":"beads install silently fails in template","description":"template.yaml line 69: 'npm install -g @anthropic-ai/beads || true' silently ignores failures. User won't know beads isn't available until they try to use it.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-09T11:49:02.105964-08:00","created_by":"danyel","updated_at":"2026-01-09T15:14:46.26904-08:00","closed_at":"2026-01-09T15:14:46.26904-08:00","close_reason":"Added CSB_WARN marker for beads install failure, plus warning display in csb start_vm"}
{"id":"csb-tfl","title":"Phase 5: Port mapping for dev servers","description":"Ensure dev server access works: assign fixed ports (agent1→5181, agent2→5182, etc), set PORT env var in docker-compose per agent, show port in dashboard agent panel, verify Lima forwards ports correctly.\n\nTesting:\n- Test PORT env var is set correctly per agent\n- Test dashboard displays correct port for each agent\n- Integration test: start dev server in agent, verify accessible from host browser\n- Test Lima port forwarding with curl from host","status":"open","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:38:14.911726-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:47:03.160004-08:00","dependencies":[{"issue_id":"csb-tfl","depends_on_id":"csb-0fc","type":"blocks","created_at":"2026-01-11T23:38:21.045125-08:00","created_by":"danyel fisher"},{"issue_id":"csb-tfl","depends_on_id":"csb-kva","type":"parent-child","created_at":"2026-01-11T23:38:34.578154-08:00","created_by":"danyel fisher"}]}
{"id":"csb-u51","title":"Add csb kill command for session cleanup","description":"Currently there is no way to clean up old tmux sessions.\n\nProposed changes:\n- Add `csb kill \u003csession\u003e` to kill a specific session\n- Optionally add `csb cleanup` to kill all sessions","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-09T15:29:13.349764-08:00","created_by":"danyel","updated_at":"2026-01-09T18:39:11.183997-08:00","closed_at":"2026-01-09T18:39:11.183997-08:00","close_reason":"Won't fix: low value. Stale sessions are rare, users can csb shell + tmux kill-session if needed."}
{"id":"csb-uj8","title":"claude should start with --dangerously-skip-permissions, and should not create a local permissions settings","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:49:38.46866-08:00","created_by":"danyel","updated_at":"2026-01-09T14:51:44.235581-08:00","closed_at":"2026-01-09T14:51:44.235581-08:00","close_reason":"Closed"}
{"id":"csb-usr","title":"Fix broken shebang in csb-setup-plugins heredoc","description":"The heredoc in template.yaml is indented, causing the generated ~/.csb-setup-plugins script to have 6 leading spaces on every line including the shebang. The script will fail to execute. Fix: de-indent heredoc content to column 0, or delete the script entirely (see YAGNI issue).","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-09T15:24:13.873358-08:00","created_by":"danyel","updated_at":"2026-01-09T15:46:24.085211-08:00","closed_at":"2026-01-09T15:46:24.085211-08:00","close_reason":"Script removed, issues are moot","dependencies":[{"issue_id":"csb-usr","depends_on_id":"csb-qhk","type":"blocks","created_at":"2026-01-09T15:24:22.045826-08:00","created_by":"danyel"}]}
{"id":"csb-uux","title":"Bug: -v flag doesn't work, help says -v but code uses -V","description":"Line 477 uses --verbose|-V but help text at line 455 says -v (lowercase). Users trying -v get 'Unknown command.'","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T11:48:56.144979-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.204278-08:00","closed_at":"2026-01-09T12:03:24.208568-08:00","close_reason":"Changed -V to -v in flag parsing to match help text"}
{"id":"csb-v0c","title":"Create pre-configured Claude VM","description":"This will be a Lima-powered VM. When the user invokes the script, it should start the VM in the current directory, setting the current directory as \"/workspace\" inside the VM. The VM should have Beads and Claude installed, and should pre-start Claude. It should have limited internet access - only for install sources like github, python repos, npm, and so on. If the user calls the script a second time in the same folder, it should use the same VM.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T10:23:37.69147-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.206932-08:00","closed_at":"2026-01-09T10:59:26.593328-08:00","close_reason":"Implementation complete: csb CLI with Lima VM template, network allowlist, and all commands implemented","comments":[{"id":1,"issue_id":"csb-v0c","author":"danyel","text":"## Design: csb (Claude SandBox)\n\n### Overview\n\nBash CLI tool using Lima VMs for sandboxed Claude development. Each project directory gets its own persistent VM with Claude Code + Superpowers pre-installed, running in YOLO mode.\n\n### Commands\n\n| Command | Description |\n|---------|-------------|\n| `csb start` | Create new Claude session, attach (creates VM on first run) |\n| `csb stop` | Shut down the VM |\n| `csb shell` | Open bash shell inside VM |\n| `csb attach \u003cn\u003e` | Attach to session n (starts VM if stopped) |\n| `csb list` | Show VM status and all sessions |\n| `csb config` | Adjust VM resources (requires restart) |\n| `csb status` | Show VM state |\n\n### Directory Mapping\n\n- `.csb` file in project root stores VM name + config\n- VM name: `csb-\u003c6-char-hash\u003e` (generated once, stored)\n- Moving directory works (name travels with .csb file)\n\n### VM Spec\n\n- **Base:** Debian slim\n- **Default resources:** 2 CPU, 2GB RAM, 20GB disk\n- **Mount:** Current directory → `/workspace`\n- **Session management:** tmux (auto-incrementing session numbers)\n\n### Network Allowlist (category-based)\n\n**Package managers:** pypi.org, registry.npmjs.org, crates.io, rubygems.org, proxy.golang.org\n\n**Code hosts:** github.com, gitlab.com, bitbucket.org (+ raw.githubusercontent.com)\n\n**Claude:** api.anthropic.com, console.anthropic.com, statsig.anthropic.com\n\nEverything else blocked via iptables.\n\n### Provisioning (first run)\n\n1. Create Lima VM from template\n2. Install: tmux, git, curl, build-essential, python3, nodejs\n3. Install: Claude Code CLI, beads, Superpowers plugin\n4. Configure YOLO mode\n5. Apply network restrictions\n\n### File Structure\n\n```\n~/.csb/\n├── template.yaml      # Lima VM template\n├── network-rules.sh   # iptables allowlist\n└── vms/               # (Lima manages in ~/.lima/)\n\n/project/\n└── .csb               # VM name + config\n```\n\n### Implementation\n\nSingle bash script (~200-300 lines) at /usr/local/bin/csb or ~/bin/csb.","created_at":"2026-01-09T18:47:08Z"}]}
{"id":"csb-v0c.1","title":"Create Lima VM template (template.yaml)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T10:54:44.047628-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.206643-08:00","closed_at":"2026-01-09T10:56:00.263018-08:00","close_reason":"Closed","dependencies":[{"issue_id":"csb-v0c.1","depends_on_id":"csb-v0c","type":"parent-child","created_at":"2026-01-09T10:54:44.048281-08:00","created_by":"danyel"}]}
{"id":"csb-v0c.2","title":"Create network allowlist script (network-rules.sh)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T10:54:44.199181-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.206351-08:00","closed_at":"2026-01-09T10:56:26.394089-08:00","close_reason":"Closed","dependencies":[{"issue_id":"csb-v0c.2","depends_on_id":"csb-v0c","type":"parent-child","created_at":"2026-01-09T10:54:44.199659-08:00","created_by":"danyel"}]}
{"id":"csb-v0c.3","title":"Create main csb bash script","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T10:54:44.349191-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.206043-08:00","closed_at":"2026-01-09T10:57:23.301453-08:00","close_reason":"Closed","dependencies":[{"issue_id":"csb-v0c.3","depends_on_id":"csb-v0c","type":"parent-child","created_at":"2026-01-09T10:54:44.349644-08:00","created_by":"danyel"},{"issue_id":"csb-v0c.3","depends_on_id":"csb-v0c.1","type":"blocks","created_at":"2026-01-09T10:54:50.104089-08:00","created_by":"danyel"},{"issue_id":"csb-v0c.3","depends_on_id":"csb-v0c.2","type":"blocks","created_at":"2026-01-09T10:54:50.186381-08:00","created_by":"danyel"}]}
{"id":"csb-v0c.4","title":"Test csb implementation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T10:54:44.503971-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.205756-08:00","closed_at":"2026-01-09T10:59:21.813443-08:00","close_reason":"Closed","dependencies":[{"issue_id":"csb-v0c.4","depends_on_id":"csb-v0c","type":"parent-child","created_at":"2026-01-09T10:54:44.504474-08:00","created_by":"danyel"},{"issue_id":"csb-v0c.4","depends_on_id":"csb-v0c.3","type":"blocks","created_at":"2026-01-09T10:54:50.267103-08:00","created_by":"danyel"}]}
{"id":"csb-vli","title":"Drop ANTHROPIC_API_KEY from template","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T22:08:38.072251-08:00","created_by":"danyel","updated_at":"2026-01-10T10:03:14.498892-08:00","closed_at":"2026-01-10T10:03:14.498892-08:00","close_reason":"Removed ANTHROPIC_API_KEY from template (commit 375c0c1)","comments":[{"id":18,"issue_id":"csb-vli","author":"danyel","text":"## Summary\nRemove ANTHROPIC_API_KEY from the Lima template environment variables.\n\n## Why\n- Reduces attack surface - key not exposed in VM environment\n- Claude Code can read from host's environment or config\n- Simplifies template\n\n## Current\n```yaml\nenv:\n  ANTHROPIC_API_KEY: \"{{ANTHROPIC_API_KEY}}\"\n```\n\n## After\nRemove the env section entirely (or keep only GITHUB_TOKEN after csb-iv9)","created_at":"2026-01-10T06:09:01Z"}]}
{"id":"csb-vo2","title":"Create install.sh script for proper system installation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T20:59:43.358106-08:00","created_by":"danyel","updated_at":"2026-01-09T21:15:33.850348-08:00","closed_at":"2026-01-09T21:15:33.850348-08:00","close_reason":"Created install.sh with install and --uninstall options","dependencies":[{"issue_id":"csb-vo2","depends_on_id":"csb-nx7","type":"blocks","created_at":"2026-01-09T21:00:09.041198-08:00","created_by":"danyel"}],"comments":[{"id":14,"issue_id":"csb-vo2","author":"danyel","text":"Create install.sh that:\n- Copies csb to /usr/local/bin/\n- Copies support files to /usr/local/share/csb/\n- Runs build-template.sh first if template.yaml doesn't exist\n- Handles uninstall with --uninstall flag","created_at":"2026-01-10T05:00:04Z"}]}
{"id":"csb-w0e","title":"csb should show errors when setup steps fail","description":"When a step of the setup fails, the spinner just runs forever. If the system has written anything to stderr, we should show that.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T16:49:48.538378-08:00","created_by":"danyel","updated_at":"2026-01-09T16:55:39.46433-08:00","closed_at":"2026-01-09T16:55:39.46433-08:00","close_reason":"Added CSB_ERROR marker detection and cloud-init result.json checking to stop spinner and show errors when setup steps fail"}
{"id":"csb-wk3","title":"Bug: crashes instantly on startup","description":"csb start exits immediately after showing 'Creating VM' message with no error output.\n\nLog:\n```\n[danyel:~/code/MISC/torahmap2] main* 1 ± ../sbmaker-2/csb/csb start\n[csb] Creating VM: csb-575525\n     This may take a few minutes on first run...\n\n[danyel:~/code/MISC/torahmap2] main* 1 ±\n```\n\nThe spinner never appears and no error is shown. Exit code is 1.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-09T11:10:57.079156-08:00","created_by":"danyel","updated_at":"2026-01-09T13:18:17.202273-08:00","closed_at":"2026-01-09T11:12:32.983763-08:00","close_reason":"Fixed two bugs: 1) vm_exists/vm_status used wrong jq syntax for Lima's JSON Lines output (not array), 2) run_with_spinner now uses || to capture exit code and calls exit directly to show errors before set -e kills script"}
{"id":"csb-wvl","title":"Trap only catches EXIT, not INT/TERM","description":"Line 104: trap 'stop_spinner false \"\"' EXIT. Ctrl+C during a spinner could leave terminal in a bad state. Should trap INT and TERM as well.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-09T11:48:57.026361-08:00","created_by":"danyel","updated_at":"2026-01-09T13:39:56.972245-08:00","closed_at":"2026-01-09T13:39:56.972245-08:00","close_reason":"Added cleanup_spinners function and trap for INT/TERM signals"}
{"id":"csb-xlp","title":"Freezes installing beads CLI","description":"## Problem\nVM provisioning freezes on \"Installing beads CLI\" step. Claude Code installs in ~2 seconds, but beads hangs indefinitely.\n\n## Location\n`csb/template.yaml:81` - `npm install -g @beads/bd`\n\n## Possible causes\n1. Package @beads/bd may not exist in npm registry\n2. Network timeout waiting for npm\n3. Missing timeout on the npm install command\n\n## Investigation needed\n- Verify @beads/bd is the correct package name\n- Check if npm install needs a timeout\n- Consider making this non-blocking or skipping if slow","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T16:48:24.906419-08:00","created_by":"danyel","updated_at":"2026-01-09T16:52:50.41566-08:00","closed_at":"2026-01-09T16:52:50.41566-08:00","close_reason":"Closed"}
{"id":"csb-y2y","title":"Fix race condition in spinner state file updates","description":"## Problem\n\nRead-then-write to spinner state file is not atomic. The spinner process could read a partial file if the write is interrupted.\n\n## Location\n\nFile: `csb` lines 107-114\n\n## Recommendation\n\nWrite to a temp file first, then use `mv` for atomic updates. The `mv` command is atomic on POSIX systems when source and destination are on the same filesystem.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T15:29:08.079339-08:00","created_by":"danyel","updated_at":"2026-01-09T18:28:54.251361-08:00","closed_at":"2026-01-09T18:28:54.251361-08:00","close_reason":"Won't fix: theoretical race with negligible impact. Small echo writes are effectively atomic, reader has fallback, and spinner self-corrects in 0.1s. The mv approach adds overhead for no real benefit."}
{"id":"csb-yoo","title":"Phase 1: Agent-side approval gate","description":"Modify entrypoint.sh to support interactive mode with human approval gate for features/bugs before merge.","status":"in_progress","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:38:14.238883-08:00","created_by":"danyel fisher","updated_at":"2026-01-12T00:00:28.847084-08:00","dependencies":[{"issue_id":"csb-yoo","depends_on_id":"csb-kva","type":"parent-child","created_at":"2026-01-11T23:38:34.574083-08:00","created_by":"danyel fisher"}]}
{"id":"csb-yoo.1","title":"Add --mode flag to csb start","description":"Parse --mode flag in cmd_start(). Validate mode is 'autonomous' or 'interactive'. Pass mode to start_agent function and docker-compose via AGENT_MODE env var.\n\nTesting: Write test_csb_mode_flag.sh to verify flag parsing.","status":"tombstone","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:50:53.864409-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:59:24.469082-08:00","dependencies":[{"issue_id":"csb-yoo.1","depends_on_id":"csb-yoo","type":"parent-child","created_at":"2026-01-11T23:50:53.864982-08:00","created_by":"danyel fisher"}],"deleted_at":"2026-01-11T23:59:24.469082-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"csb-yoo.2","title":"Create status directory structure","description":"Add init_status_dir(), write_status(), write_output() functions to entrypoint.sh. Create /workspace/.csb/agentN/ with status, task, output.log files. Call init_status_dir in main().\n\nTesting: Write test_status_files.sh to verify directory structure.","status":"tombstone","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:50:54.063935-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:59:24.469082-08:00","dependencies":[{"issue_id":"csb-yoo.2","depends_on_id":"csb-yoo","type":"parent-child","created_at":"2026-01-11T23:50:54.064499-08:00","created_by":"danyel fisher"},{"issue_id":"csb-yoo.2","depends_on_id":"csb-yoo.1","type":"blocks","created_at":"2026-01-11T23:51:01.91276-08:00","created_by":"danyel fisher"}],"deleted_at":"2026-01-11T23:59:24.469082-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"csb-yoo.3","title":"Write status updates during agent loop","description":"Update agent_loop() to call write_status() and write_output() at each stage: idle, working, task claimed, work complete, error.","status":"tombstone","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:50:54.240113-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:59:24.469082-08:00","dependencies":[{"issue_id":"csb-yoo.3","depends_on_id":"csb-yoo","type":"parent-child","created_at":"2026-01-11T23:50:54.240636-08:00","created_by":"danyel fisher"},{"issue_id":"csb-yoo.3","depends_on_id":"csb-yoo.2","type":"blocks","created_at":"2026-01-11T23:51:01.975596-08:00","created_by":"danyel fisher"}],"deleted_at":"2026-01-11T23:59:24.469082-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"csb-yoo.4","title":"Get task type from beads","description":"Add get_task_type() to parse type from bd show --json. Add requires_approval() to check if feature/bug (needs approval) vs chore/refactor (auto-merge).\n\nTesting: Write test_task_type.sh with mock bd output.","status":"tombstone","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:50:54.408072-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:59:24.469082-08:00","dependencies":[{"issue_id":"csb-yoo.4","depends_on_id":"csb-yoo","type":"parent-child","created_at":"2026-01-11T23:50:54.408567-08:00","created_by":"danyel fisher"},{"issue_id":"csb-yoo.4","depends_on_id":"csb-yoo.2","type":"blocks","created_at":"2026-01-11T23:51:02.033761-08:00","created_by":"danyel fisher"}],"deleted_at":"2026-01-11T23:59:24.469082-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"csb-yoo.5","title":"Implement approval request/response","description":"Add write_approval_request() to write JSON with task_id, type, diff_summary, commit_message, test_status. Add wait_for_approval() to poll for response file. Add cleanup_approval().\n\nTesting: Write test_approval_flow.sh.","status":"tombstone","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:50:54.577627-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:59:24.469082-08:00","dependencies":[{"issue_id":"csb-yoo.5","depends_on_id":"csb-yoo","type":"parent-child","created_at":"2026-01-11T23:50:54.578114-08:00","created_by":"danyel fisher"},{"issue_id":"csb-yoo.5","depends_on_id":"csb-yoo.4","type":"blocks","created_at":"2026-01-11T23:51:02.100123-08:00","created_by":"danyel fisher"}],"deleted_at":"2026-01-11T23:59:24.469082-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"csb-yoo.6","title":"Modify finalize_work for approval gate","description":"Split finalize_work into prepare_merge() and execute_merge(). In interactive mode, check task type - if feature/bug, write_status needs_approval, write_approval_request, wait_for_approval. On rejection, call claude --continue for feedback.","status":"tombstone","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:50:54.752438-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:59:24.469082-08:00","dependencies":[{"issue_id":"csb-yoo.6","depends_on_id":"csb-yoo","type":"parent-child","created_at":"2026-01-11T23:50:54.752938-08:00","created_by":"danyel fisher"},{"issue_id":"csb-yoo.6","depends_on_id":"csb-yoo.5","type":"blocks","created_at":"2026-01-11T23:51:02.162264-08:00","created_by":"danyel fisher"},{"issue_id":"csb-yoo.6","depends_on_id":"csb-yoo.3","type":"blocks","created_at":"2026-01-11T23:51:02.226413-08:00","created_by":"danyel fisher"}],"deleted_at":"2026-01-11T23:59:24.469082-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"csb-yoo.7","title":"Update do_work for interactive mode","description":"Modify prompt in do_work() for interactive mode to say 'do NOT push or merge - that will be handled after human approval'. Tee claude output to output.log.","status":"tombstone","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:50:54.957481-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:59:24.469082-08:00","dependencies":[{"issue_id":"csb-yoo.7","depends_on_id":"csb-yoo","type":"parent-child","created_at":"2026-01-11T23:50:54.957972-08:00","created_by":"danyel fisher"},{"issue_id":"csb-yoo.7","depends_on_id":"csb-yoo.2","type":"blocks","created_at":"2026-01-11T23:51:02.290795-08:00","created_by":"danyel fisher"}],"deleted_at":"2026-01-11T23:59:24.469082-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"csb-yoo.8","title":"Integration test for approval flow","description":"Write test_integration_approval.sh that simulates full flow: agent claims task, writes working status, completes work, writes needs_approval, dashboard writes approved response, agent proceeds.","status":"tombstone","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:50:55.128116-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:59:24.469082-08:00","dependencies":[{"issue_id":"csb-yoo.8","depends_on_id":"csb-yoo","type":"parent-child","created_at":"2026-01-11T23:50:55.128565-08:00","created_by":"danyel fisher"},{"issue_id":"csb-yoo.8","depends_on_id":"csb-yoo.6","type":"blocks","created_at":"2026-01-11T23:51:02.351991-08:00","created_by":"danyel fisher"},{"issue_id":"csb-yoo.8","depends_on_id":"csb-yoo.7","type":"blocks","created_at":"2026-01-11T23:51:02.417178-08:00","created_by":"danyel fisher"}],"deleted_at":"2026-01-11T23:59:24.469082-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"csb-yoo.9","title":"Run all tests and close Phase 1","description":"Run all test scripts, verify entrypoint.sh syntax with bash -n, close csb-yoo bead.","status":"tombstone","priority":2,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T23:50:55.291307-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T23:59:24.469082-08:00","dependencies":[{"issue_id":"csb-yoo.9","depends_on_id":"csb-yoo","type":"parent-child","created_at":"2026-01-11T23:50:55.291776-08:00","created_by":"danyel fisher"},{"issue_id":"csb-yoo.9","depends_on_id":"csb-yoo.8","type":"blocks","created_at":"2026-01-11T23:51:02.477077-08:00","created_by":"danyel fisher"}],"deleted_at":"2026-01-11T23:59:24.469082-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"csb-ys7","title":"Update README with system installation instructions","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T20:59:43.505146-08:00","created_by":"danyel","updated_at":"2026-01-09T21:17:02.899354-08:00","closed_at":"2026-01-09T21:17:02.899354-08:00","close_reason":"Updated README with system install and dev install sections","dependencies":[{"issue_id":"csb-ys7","depends_on_id":"csb-nx7","type":"blocks","created_at":"2026-01-09T21:00:09.100848-08:00","created_by":"danyel"},{"issue_id":"csb-ys7","depends_on_id":"csb-vo2","type":"blocks","created_at":"2026-01-09T21:00:09.15668-08:00","created_by":"danyel"}],"comments":[{"id":15,"issue_id":"csb-ys7","author":"danyel","text":"Document:\n- System install via install.sh\n- Dev install (clone + PATH)\n- File locations (/usr/local/bin, /usr/local/share/csb)","created_at":"2026-01-10T05:00:04Z"}]}
{"id":"csb-ywn","title":"Background spinner prevents Ctrl+C from stopping build","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T13:38:48.118461-08:00","created_by":"danyel","updated_at":"2026-01-09T13:39:56.970478-08:00","closed_at":"2026-01-09T13:39:56.970478-08:00","close_reason":"Added cleanup_spinners function and trap for INT/TERM signals"}
{"id":"csb-yzw","title":"[TEST-2] Multi-agent test task 2","description":"Test task for Phase 3 multi-agent validation. Simple placeholder task.","status":"closed","priority":0,"issue_type":"task","owner":"danyel@gmail.com","created_at":"2026-01-11T21:34:04.352349-08:00","created_by":"danyel fisher","updated_at":"2026-01-11T21:51:58.868231-08:00","closed_at":"2026-01-11T21:51:58.868231-08:00","close_reason":"Test tasks for Phase 3 validation. Cleaning up."}
{"id":"csb-z6a","title":"Extract require_vm helper (repeated pattern)","description":"## Problem\nThe same VM existence check is repeated 6 times across commands:\n- cmd_stop (lines 463-467)\n- cmd_shell (lines 477-479)\n- cmd_attach (lines 492-495)\n- cmd_config (lines 556-559)\n- cmd_destroy (lines 585-588)\n- cmd_status (lines 535-538, slightly different)\n\n## Solution\nExtract helper function:\n```bash\nrequire_vm() {\n    local vm_name=\"$1\"\n    local msg=\"${2:-No VM found for this directory}\"\n    if ! vm_exists \"${vm_name}\"; then\n        error \"${msg}\"\n        exit 1\n    fi\n}\n```\n\n## File\n- `csb/csb`","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T15:37:54.540959-08:00","created_by":"danyel","updated_at":"2026-01-09T15:50:35.823543-08:00","closed_at":"2026-01-09T15:50:35.823543-08:00","close_reason":"Closed"}
{"id":"csb-zaj","title":"UUOC: cat piped to tail","description":"Line 359: cat \"${CSB_FILE}\" | tail -n +2. Should be: tail -n +2 \"${CSB_FILE}\"","status":"closed","priority":4,"issue_type":"chore","created_at":"2026-01-09T11:49:01.741074-08:00","created_by":"danyel","updated_at":"2026-01-09T13:51:17.939157-08:00","closed_at":"2026-01-09T13:51:17.939157-08:00","close_reason":"Closed"}
{"id":"csb-zbc","title":"DNS-based firewall is fragile - IPs change over time","description":"network-rules.sh resolves domains to IPs at setup time. CDNs rotate IPs constantly, so the allowlist drifts out of date. Consider using domain-based filtering (iptables with string match or a proxy) instead.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T11:48:56.843726-08:00","created_by":"danyel","updated_at":"2026-01-09T14:47:31.844141-08:00","closed_at":"2026-01-09T14:47:31.844141-08:00","close_reason":"Won't fix: For 1-2 day VM lifespans, resolve-once-at-boot is sufficient. CDN IPs don't rotate fast enough to matter."}
{"id":"csb-zqh","title":"Add shellcheck compliance","description":"## Problem\nScript lacks shellcheck directive and has patterns that would trigger warnings:\n- Missing `# shellcheck shell=bash` directive\n- `local var=$(...)` pattern can mask failures\n- Mixed quote/redirect styles\n\n## Solution\n1. Add `# shellcheck shell=bash` at top\n2. Split local declarations from assignments where appropriate:\n   ```bash\n   local create_start_time\n   create_start_time=$(date +%s)\n   ```\n3. Run shellcheck and fix any remaining warnings\n\n## File\n- `csb/csb`","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T15:37:49.298138-08:00","created_by":"danyel","updated_at":"2026-01-09T18:36:56.221366-08:00","closed_at":"2026-01-09T18:36:56.221366-08:00","close_reason":"Won't fix: low ROI housekeeping. The local x=$(cmd) pattern rarely causes real issues in practice."}
